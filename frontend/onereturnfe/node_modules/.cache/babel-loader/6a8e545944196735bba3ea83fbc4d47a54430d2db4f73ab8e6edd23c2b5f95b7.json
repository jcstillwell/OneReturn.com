{"ast":null,"code":"import _slicedToArray from\"Z:/OR-dev/OR-Localdev/frontend/onereturnfe/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState,useContext,useParams}from\"react\";import{Router,Switch,Route,Link}from'react-router-dom';import PopupWindow from\"../auth/PopupWindow\";import Portal from\"../../Util/Portal\";import Invoice from\"./Invoice\";import Searchbar from\"./Searchbar\";import axios from\"axios\";import Cookies from\"js-cookie\";import'./wallet.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var BACKEND=process.env.REACT_APP_BACKEND;var Wallet=function Wallet(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),invoices=_useState2[0],setInvoices=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),dropdownIndex=_useState4[0],setDropdownIndex=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),shareIndex=_useState6[0],setShareIndex=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),deleteIndex=_useState8[0],setDeleteIndex=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),currInvoice=_useState10[0],setCurrInvoice=_useState10[1];var data;try{data=JSON.parse(Cookies.get('data'));}catch(e){console.log(\"error parsing cookie: \",e);data={};}var handleSearchResults=function handleSearchResults(results){setInvoices(results);};var toggleDropdown=function toggleDropdown(index){if(dropdownIndex===index){setDropdownIndex(null);}else{setDropdownIndex(index);}};var togglePopupShare=function togglePopupShare(index){if(shareIndex===index){setShareIndex(null);}else{setShareIndex(index);}};var togglePopupDelete=function togglePopupDelete(index){if(deleteIndex===index){setDeleteIndex(null);}else{setDeleteIndex(index);}};var editReceipt=function editReceipt(action,invoiceID,recipientID){var sharedWith=arguments.length>3&&arguments[3]!==undefined?arguments[3]:'';var itemName=arguments.length>4&&arguments[4]!==undefined?arguments[4]:'';var returner=arguments.length>5&&arguments[5]!==undefined?arguments[5]:'';var token=Cookies.get('token');console.log(sharedWith);axios.post(BACKEND+'/edit/',{action:action,invoiceID:invoiceID,recipientID:recipientID,sharedWith:sharedWith,itemName:itemName,returner:returner},{headers:{Authorization:\"Token \".concat(token)}}).then(function(response){console.log(response);fetchData();console.log(\"current version updated\");}).catch(function(error){console.error('error: ',error);});};var fetchData=function fetchData(){var token=Cookies.get('token');axios.get(BACKEND+'/get/',{headers:{'Authorization':\"Token \"+token}}).then(function(response){console.log(response);setInvoices(response.data.invoices);}).catch(function(error){console.error('error: ',error);});};useEffect(function(){fetchData();},[]);useEffect(function(){if(invoices.length>0){setCurrInvoice(invoices[0].invoice.invoiceID);}},[invoices]);var setInvoiceFocus=function setInvoiceFocus(invoiceID){setCurrInvoice(invoiceID);console.log(\"set: \"+invoiceID);};return/*#__PURE__*/_jsxs(\"div\",{className:\"main-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"searchbar-container\",children:/*#__PURE__*/_jsx(Searchbar,{onSearch:handleSearchResults})}),/*#__PURE__*/_jsx(\"div\",{className:\"invoices-nondetailed-list\",children:!invoices||invoices.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"ndinvoicebox\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No receipts found\"})}):invoices.map(function(invoice,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"ndinvoicebox\",onClick:function onClick(){return setInvoiceFocus(invoice.invoice.invoiceID);},children:[console.log(invoice.invoice.invoiceID),/*#__PURE__*/_jsx(\"h2\",{children:invoice.invoice.invoiceID})]},index);})}),/*#__PURE__*/_jsx(\"div\",{className:\"invoice-detailed\",children:currInvoice&&/*#__PURE__*/_jsx(Invoice,{invoiceID:currInvoice})})]});};export default Wallet;","map":{"version":3,"names":["React","useEffect","useState","useContext","useParams","Router","Switch","Route","Link","PopupWindow","Portal","Invoice","Searchbar","axios","Cookies","jsx","_jsx","jsxs","_jsxs","BACKEND","process","env","REACT_APP_BACKEND","Wallet","_useState","_useState2","_slicedToArray","invoices","setInvoices","_useState3","_useState4","dropdownIndex","setDropdownIndex","_useState5","_useState6","shareIndex","setShareIndex","_useState7","_useState8","deleteIndex","setDeleteIndex","_useState9","_useState10","currInvoice","setCurrInvoice","data","JSON","parse","get","e","console","log","handleSearchResults","results","toggleDropdown","index","togglePopupShare","togglePopupDelete","editReceipt","action","invoiceID","recipientID","sharedWith","arguments","length","undefined","itemName","returner","token","post","headers","Authorization","concat","then","response","fetchData","catch","error","invoice","setInvoiceFocus","className","children","onSearch","map","onClick"],"sources":["Z:/OR-dev/OR-Localdev/frontend/onereturnfe/src/pages/app/Wallet.js"],"sourcesContent":["import React, { useEffect, useState, useContext, useParams } from \"react\";\r\nimport {Router, Switch, Route, Link } from 'react-router-dom';\r\nimport PopupWindow from \"../auth/PopupWindow\";\r\nimport Portal from \"../../Util/Portal\";\r\nimport Invoice from \"./Invoice\";\r\nimport Searchbar from \"./Searchbar\";\r\nimport axios from \"axios\";\r\nimport Cookies from \"js-cookie\";\r\nimport './wallet.css'\r\n\r\nconst BACKEND = process.env.REACT_APP_BACKEND;\r\n\r\nconst Wallet = () => {\r\n\r\n    const [invoices, setInvoices] = useState([]);\r\n    const [dropdownIndex, setDropdownIndex] = useState(null);\r\n    const [shareIndex, setShareIndex] = useState(null);\r\n    const [deleteIndex, setDeleteIndex] = useState(null);\r\n    const [currInvoice, setCurrInvoice] = useState(null);\r\n\r\n    let data;\r\n    try {\r\n        data = JSON.parse(Cookies.get('data'));\r\n    } catch (e) {\r\n        console.log(\"error parsing cookie: \", e);\r\n        data = {};\r\n    }\r\n\r\n    const handleSearchResults = (results) => {\r\n        setInvoices(results)\r\n    }\r\n\r\n    const toggleDropdown = (index) => {\r\n        if(dropdownIndex === index) {\r\n            setDropdownIndex(null);\r\n        } else {\r\n            setDropdownIndex(index);\r\n        }\r\n    }\r\n\r\n    const togglePopupShare = (index) => {\r\n        if(shareIndex === index) {\r\n            setShareIndex(null);\r\n        } else {\r\n            setShareIndex(index);\r\n        }\r\n    }\r\n\r\n    const togglePopupDelete = (index) => {\r\n        if(deleteIndex === index) {\r\n            setDeleteIndex(null);\r\n        } else {\r\n            setDeleteIndex(index);\r\n        }\r\n    }\r\n\r\n    const editReceipt = (action, invoiceID, recipientID, sharedWith='', itemName='', returner='') => {\r\n        const token = Cookies.get('token');\r\n        console.log(sharedWith);\r\n        axios\r\n        .post(\r\n            BACKEND+'/edit/',\r\n            {\r\n              action: action,\r\n              invoiceID: invoiceID,\r\n              recipientID: recipientID,\r\n              sharedWith: sharedWith,\r\n              itemName: itemName,\r\n              returner: returner\r\n            },\r\n            {\r\n              headers: {\r\n                Authorization: `Token ${token}`,\r\n              },\r\n            }\r\n          )\r\n          .then((response) => {\r\n            console.log(response);\r\n            fetchData();\r\n            console.log(\"current version updated\")\r\n          })\r\n          .catch((error) => {\r\n            console.error('error: ', error);\r\n          });\r\n      };\r\n\r\n    const fetchData = () => {\r\n        const token = Cookies.get('token');\r\n        axios.get(BACKEND+'/get/', {\r\n            headers: {\r\n                'Authorization': \"Token \" + token\r\n            }\r\n        })\r\n        .then((response) => {\r\n            console.log(response);\r\n            setInvoices(response.data.invoices);\r\n        })\r\n        .catch((error) => {\r\n            console.error('error: ', error);\r\n        });\r\n    }\r\n\r\n    useEffect(() => {\r\n        fetchData();\r\n     }, []);\r\n\r\n     useEffect(() => {\r\n        if (invoices.length > 0) {\r\n            setCurrInvoice(invoices[0].invoice.invoiceID);\r\n        }\r\n     }, [invoices]);\r\n\r\n    const setInvoiceFocus = (invoiceID) => {\r\n        setCurrInvoice(invoiceID);\r\n        console.log(\"set: \" + invoiceID);\r\n    }\r\n\r\n    return (\r\n        <div className=\"main-container\">\r\n            <div className=\"searchbar-container\">\r\n                <Searchbar onSearch={handleSearchResults}/>\r\n            </div>\r\n            <div className=\"invoices-nondetailed-list\">\r\n                {!invoices || invoices.length === 0 ? (\r\n                    <div className=\"ndinvoicebox\">\r\n                    <p>No receipts found</p>\r\n                    </div>\r\n                ) : (\r\n                    invoices.map((invoice, index) => (\r\n                    <div className='ndinvoicebox' key={index} onClick={() => setInvoiceFocus(invoice.invoice.invoiceID)}>\r\n                        {console.log(invoice.invoice.invoiceID)}\r\n                        <h2>{invoice.invoice.invoiceID}</h2>\r\n                    </div>\r\n                    ))\r\n                )}\r\n            </div>\r\n            <div className=\"invoice-detailed\">\r\n                {currInvoice && <Invoice invoiceID={currInvoice}/> }\r\n            </div>\r\n        </div>\r\n        );\r\n}\r\n\r\n\r\nexport default Wallet;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}