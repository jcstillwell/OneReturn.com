{"ast":null,"code":"import React,{useEffect,useState,useContext,useParams}from\"react\";import{Router,Switch,Route,Link}from'react-router-dom';import PopupWindow from\"../auth/PopupWindow\";import Portal from\"../../Util/Portal\";import Invoice from\"./Invoice\";import Searchbar from\"./Searchbar\";import axios from\"axios\";import Cookies from\"js-cookie\";import'./wallet.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const BACKEND=process.env.REACT_APP_BACKEND;const Wallet=()=>{const[invoices,setInvoices]=useState([]);const[dropdownIndex,setDropdownIndex]=useState(null);const[shareIndex,setShareIndex]=useState(null);const[deleteIndex,setDeleteIndex]=useState(null);const[currInvoice,setCurrInvoice]=useState(null);let data;try{data=JSON.parse(Cookies.get('data'));}catch(e){console.log(\"error parsing cookie: \",e);data={};}const handleSearchResults=results=>{setInvoices(results);};const toggleDropdown=index=>{if(dropdownIndex===index){setDropdownIndex(null);}else{setDropdownIndex(index);}};const togglePopupShare=index=>{if(shareIndex===index){setShareIndex(null);}else{setShareIndex(index);}};const togglePopupDelete=index=>{if(deleteIndex===index){setDeleteIndex(null);}else{setDeleteIndex(index);}};const editReceipt=function(action,invoiceID,recipientID){let sharedWith=arguments.length>3&&arguments[3]!==undefined?arguments[3]:'';let itemName=arguments.length>4&&arguments[4]!==undefined?arguments[4]:'';let returner=arguments.length>5&&arguments[5]!==undefined?arguments[5]:'';const token=Cookies.get('token');console.log(sharedWith);axios.post(BACKEND+'/edit/',{action:action,invoiceID:invoiceID,recipientID:recipientID,sharedWith:sharedWith,itemName:itemName,returner:returner},{headers:{Authorization:\"Token \".concat(token)}}).then(response=>{console.log(response);fetchData();console.log(\"current version updated\");}).catch(error=>{console.error('error: ',error);});};const fetchData=()=>{const token=Cookies.get('token');axios.get(BACKEND+'/get/',{headers:{'Authorization':\"Token \"+token}}).then(response=>{console.log(response);setInvoices(response.data.invoices);}).catch(error=>{console.error('error: ',error);});};useEffect(()=>{fetchData();},[]);useEffect(()=>{if(invoices.length>0){setCurrInvoice(invoices[0].invoice.invoiceID);}},[invoices]);const setInvoiceFocus=invoiceID=>{setCurrInvoice(invoiceID);console.log(\"set: \"+invoiceID);};return/*#__PURE__*/_jsxs(\"div\",{className:\"main-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"searchbar-container\",children:/*#__PURE__*/_jsx(Searchbar,{onSearch:handleSearchResults})}),/*#__PURE__*/_jsx(\"div\",{className:\"invoices-nondetailed-list\",children:!invoices||invoices.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"ndinvoicebox\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No receipts found\"})}):invoices.map((invoice,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"ndinvoicebox\",onClick:()=>setInvoiceFocus(invoice.invoice.invoiceID),children:[console.log(invoice.invoice.invoiceID),/*#__PURE__*/_jsx(\"h2\",{children:invoice.invoice.invoiceID})]},index))}),/*#__PURE__*/_jsx(\"div\",{className:\"invoice-detailed\",children:currInvoice&&/*#__PURE__*/_jsx(Invoice,{invoiceID:currInvoice})})]});};export default Wallet;","map":{"version":3,"names":["React","useEffect","useState","useContext","useParams","Router","Switch","Route","Link","PopupWindow","Portal","Invoice","Searchbar","axios","Cookies","jsx","_jsx","jsxs","_jsxs","BACKEND","process","env","REACT_APP_BACKEND","Wallet","invoices","setInvoices","dropdownIndex","setDropdownIndex","shareIndex","setShareIndex","deleteIndex","setDeleteIndex","currInvoice","setCurrInvoice","data","JSON","parse","get","e","console","log","handleSearchResults","results","toggleDropdown","index","togglePopupShare","togglePopupDelete","editReceipt","action","invoiceID","recipientID","sharedWith","arguments","length","undefined","itemName","returner","token","post","headers","Authorization","concat","then","response","fetchData","catch","error","invoice","setInvoiceFocus","className","children","onSearch","map","onClick"],"sources":["Z:/OR-dev/OR-Localdev/frontend/onereturnfe/src/pages/app/Wallet.js"],"sourcesContent":["import React, { useEffect, useState, useContext, useParams } from \"react\";\r\nimport {Router, Switch, Route, Link } from 'react-router-dom';\r\nimport PopupWindow from \"../auth/PopupWindow\";\r\nimport Portal from \"../../Util/Portal\";\r\nimport Invoice from \"./Invoice\";\r\nimport Searchbar from \"./Searchbar\";\r\nimport axios from \"axios\";\r\nimport Cookies from \"js-cookie\";\r\nimport './wallet.css'\r\n\r\nconst BACKEND = process.env.REACT_APP_BACKEND;\r\n\r\nconst Wallet = () => {\r\n\r\n    const [invoices, setInvoices] = useState([]);\r\n    const [dropdownIndex, setDropdownIndex] = useState(null);\r\n    const [shareIndex, setShareIndex] = useState(null);\r\n    const [deleteIndex, setDeleteIndex] = useState(null);\r\n    const [currInvoice, setCurrInvoice] = useState(null);\r\n\r\n    let data;\r\n    try {\r\n        data = JSON.parse(Cookies.get('data'));\r\n    } catch (e) {\r\n        console.log(\"error parsing cookie: \", e);\r\n        data = {};\r\n    }\r\n\r\n    const handleSearchResults = (results) => {\r\n        setInvoices(results)\r\n    }\r\n\r\n    const toggleDropdown = (index) => {\r\n        if(dropdownIndex === index) {\r\n            setDropdownIndex(null);\r\n        } else {\r\n            setDropdownIndex(index);\r\n        }\r\n    }\r\n\r\n    const togglePopupShare = (index) => {\r\n        if(shareIndex === index) {\r\n            setShareIndex(null);\r\n        } else {\r\n            setShareIndex(index);\r\n        }\r\n    }\r\n\r\n    const togglePopupDelete = (index) => {\r\n        if(deleteIndex === index) {\r\n            setDeleteIndex(null);\r\n        } else {\r\n            setDeleteIndex(index);\r\n        }\r\n    }\r\n\r\n    const editReceipt = (action, invoiceID, recipientID, sharedWith='', itemName='', returner='') => {\r\n        const token = Cookies.get('token');\r\n        console.log(sharedWith);\r\n        axios\r\n        .post(\r\n            BACKEND+'/edit/',\r\n            {\r\n              action: action,\r\n              invoiceID: invoiceID,\r\n              recipientID: recipientID,\r\n              sharedWith: sharedWith,\r\n              itemName: itemName,\r\n              returner: returner\r\n            },\r\n            {\r\n              headers: {\r\n                Authorization: `Token ${token}`,\r\n              },\r\n            }\r\n          )\r\n          .then((response) => {\r\n            console.log(response);\r\n            fetchData();\r\n            console.log(\"current version updated\")\r\n          })\r\n          .catch((error) => {\r\n            console.error('error: ', error);\r\n          });\r\n      };\r\n\r\n    const fetchData = () => {\r\n        const token = Cookies.get('token');\r\n        axios.get(BACKEND+'/get/', {\r\n            headers: {\r\n                'Authorization': \"Token \" + token\r\n            }\r\n        })\r\n        .then((response) => {\r\n            console.log(response);\r\n            setInvoices(response.data.invoices);\r\n        })\r\n        .catch((error) => {\r\n            console.error('error: ', error);\r\n        });\r\n    }\r\n\r\n    useEffect(() => {\r\n        fetchData();\r\n     }, []);\r\n\r\n     useEffect(() => {\r\n        if (invoices.length > 0) {\r\n            setCurrInvoice(invoices[0].invoice.invoiceID);\r\n        }\r\n     }, [invoices]);\r\n\r\n    const setInvoiceFocus = (invoiceID) => {\r\n        setCurrInvoice(invoiceID);\r\n        console.log(\"set: \" + invoiceID);\r\n    }\r\n\r\n    return (\r\n        <div className=\"main-container\">\r\n            <div className=\"searchbar-container\">\r\n                <Searchbar onSearch={handleSearchResults}/>\r\n            </div>\r\n            <div className=\"invoices-nondetailed-list\">\r\n                {!invoices || invoices.length === 0 ? (\r\n                    <div className=\"ndinvoicebox\">\r\n                    <p>No receipts found</p>\r\n                    </div>\r\n                ) : (\r\n                    invoices.map((invoice, index) => (\r\n                    <div className='ndinvoicebox' key={index} onClick={() => setInvoiceFocus(invoice.invoice.invoiceID)}>\r\n                        {console.log(invoice.invoice.invoiceID)}\r\n                        <h2>{invoice.invoice.invoiceID}</h2>\r\n                    </div>\r\n                    ))\r\n                )}\r\n            </div>\r\n            <div className=\"invoice-detailed\">\r\n                {currInvoice && <Invoice invoiceID={currInvoice}/> }\r\n            </div>\r\n        </div>\r\n        );\r\n}\r\n\r\n\r\nexport default Wallet;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}